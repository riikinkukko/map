{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Карта</title>
  <link rel="stylesheet" href="{% static 'css/map.css' %}">
</head>
<body>
<nav class="navbar">
  <a class="logo" href="/"><img src="{% static 'img/LOGOPIXX.jpg' %}" width="34px" height="34px"></a>
  <div class="nav-links">
    {% if is_superuser %}
      <a href="/moderation/">Панель модерации</a>
    {% endif %}
    {% if request.user.is_authenticated %}
        <a href="/upload/">Загрузить фото</a>
    {% endif %}
    <a href="/gallery/">Галерея</a>
    {% if request.user.is_authenticated %}
      <a href="/profile/" class="user-link">{{ request.user }}</a>
      <a href="/logout/" class="user-link">Выход</a>
    {% else %}
      <a href="/login/" class="user-link">Войти</a>
    {% endif %}
  </div>
  {% if request.user.is_authenticated %}
  <div class="user-section">
    <a href="/profile/">{{ request.user }}</a>
    <button class="logout-button" onclick="window.location.href='/logout/'">
      <svg xmlns="http://www.w3.org/2000/svg" class="door-icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M10 17l5-5-5-5" stroke="white"/>
        <path d="M4 12h11" stroke="white"/>
        <path d="M20 4v16a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2z" stroke="white"/>
      </svg>
      Выход
    </button>
  </div>
  {% else %}
    <a href="/login/" class="user-section">Войти</a>
  {% endif %}
</nav>

<div id="map"></div>

<div class="events-control">
  <button class="events-toggle" id="eventsToggle">События</button>
  <div class="tags-list" id="tagsList"></div>
</div>

<div class="timeline-container">
  <div class="timeline">
    <div class="current-year-display" id="currentYearDisplay">Все года</div>
    <input type="range" min="1900" max="2025" value="2025" class="timeline-slider" id="yearSlider">
    <div class="timeline-labels">
      <span id="minYearLabel">1900</span>
      <span id="maxYearLabel">2025</span>
    </div>
  </div>
</div>
<div id="cookieBanner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #4264fb; color: white; padding: 16px; text-align: center; z-index: 2000; font-size: 14px; display: none;">
  <div style="max-width: 800px; margin: 0 auto;">
    Сайт использует сервисы веб-аналитики Яндекс Метрика и Спутник с помощью технологии "cookie", чтобы пользоваться сайтом было удобнее. Вы можете запретить обработку cookies в настройках браузера. Подробнее в Политике
    <button id="acceptCookies" style="margin-top: 8px; margin-left: 12px; background: white; color: #4264fb; padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">
      Я согласен
    </button>
  </div>
</div>
<button class="locate-button" onclick="locateUser()">Я</button>
<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&apikey=85851f3b-1499-46d5-9c09-9bf5c19c7823" type="text/javascript"></script>
<script>
  if (!localStorage.getItem('cookieAccepted')) {
    document.getElementById('cookieBanner').style.display = 'block';
  }

  document.getElementById('acceptCookies').addEventListener('click', function () {
    localStorage.setItem('cookieAccepted', 'true');
    document.getElementById('cookieBanner').style.display = 'none';
  });
</script>
<script>
  window.userIsAuthenticated = {{ request.user.is_authenticated|yesno:"true,false" }};
</script>
<script src="{% static 'js/map.js' %}"></script>
</body>
</html>